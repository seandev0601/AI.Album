# UI/UX 規格文件 (UISpec.md) - 照片故事 Metadata 功能

> 版本: 1.1
> 日期: 2025-05-22
> PBI: [照片添加故事文字讀寫功能](./AlbumPBI.md)
> Task Breakdown: [Task.md](./Task.md)

---

## 1. 總覽

本文件描述「照片添加故事文字讀寫功能」的使用者介面 (UI) 和使用者體驗 (UX) 設計規格。目標是提供一個直觀、簡潔且易於操作的介面，讓使用者可以輕鬆地為照片添加、閱讀和管理故事內容。

## 2. 設計原則

*   **直觀性**: 使用者無需額外學習即可理解如何操作。
*   **簡潔性**: 介面元素清晰，避免不必要的複雜性。
*   **即時性**: 操作反饋及時，減少使用者等待感。
*   **一致性**: 遵循 iOS 平台設計規範，並與 App 其他功能保持一致。

## 3. 使用者流程 (User Flow)

```mermaid
graph TD
    A[開啟 App] --> B{首次使用?};
    B -- 是 --> C[請求相簿權限];
    C -- 允許 --> D[顯示相簿照片列表];
    C -- 拒絕 --> E[顯示權限提示與引導];
    B -- 否 --> D;
    D -- 選擇照片 --> F{照片格式支援?};
    F -- 是 (JPG, PNG, JPEG) --> G[照片詳情頁];
    F -- 否 (如 HEIC) --> H[Toast提示: "格式暫不支援"];
    H --> D;
    G --> I{照片已有故事?};
    I -- 是 --> J[顯示照片 & 自動載入故事於輸入框];
    I -- 否 --> K[顯示照片 & 空白故事輸入框];
    J --> L[編輯/查看故事];
    K --> L;
    L -- 輸入文字 --> M{字數 > 300?};
    M -- 是 --> N[顯示字數上限提示 & 阻止輸入];
    M -- 否 --> O[即時更新字數統計];
    L -- 點擊儲存按鈕 --> P[顯示載入指示器];
    P --> Q[Alert: "儲存後將覆蓋原照片檔案，是否繼續？" 按鈕: "確認", "取消"];
    Q -- 確認 --> R[執行儲存];
    R -- 成功 --> S[Toast提示: "故事已儲存"];
    S --> T[更新UI & 隱藏載入指示器];
    R -- 失敗 --> U[Toast提示: "儲存失敗，[具體原因]" 如 "請檢查儲存權限"];
    U --> T;
    Q -- 取消 --> T;
    G -- 返回 --> D;
```

## 4. 介面版面 (Layout)

### 4.1. 相簿瀏覽頁

*   **佈局**: 標準的照片網格視圖 (Grid View) 或列表視圖 (List View)，類似系統相簿。
*   **元素**:
    *   照片縮圖。
    *   可能需要的排序或篩選控制項 (本階段PBI未要求)。

### 4.2. 照片詳情與故事編輯頁

*   **佈局**: 垂直佈局。
    *   **頂部**: 顯示單張照片，佔據螢幕主要區域。
    *   **底部**: 照片下方為故事輸入區域。
*   **元素**:
    *   **照片顯示區**: 清晰展示所選照片。
    *   **故事輸入框 (`TextEditor`)**:
        *   多行文字輸入區域。
        *   若照片已有故事，自動填入該故事內容。
        *   Placeholder 文字 (例如: "在這裡寫下照片的故事...")。
    *   **字數計數器**: 即時顯示目前輸入字數及上限 (例如: "120/300 字")。
        *   當超過300字時，提示文字變為警告色 (例如紅色)。
    *   **儲存按鈕**: 用於儲存故事內容。
    *   **導覽列 (Navigation Bar)**:
        *   返回按鈕: 返回相簿瀏覽頁。
        *   標題: 可顯示照片日期或其他相關資訊 (可選)。

## 5. 互動設計 (Interactions)

### 5.1. 權限請求

*   **時機**: App 首次啟動或首次嘗試存取相簿時。
*   **互動**: 顯示 iOS 標準的相簿權限請求彈窗。
*   **回饋**:
    *   若使用者拒絕，顯示一則簡短訊息說明為何需要權限，並可引導至系統設定頁。

### 5.2. 文字輸入與限制

*   **即時更新**: 字數計數器隨使用者輸入即時更新。
*   **字數超限**: 當輸入文字超過 300 字時:
    *   系統應阻止使用者輸入更多字元。
    *   字數計數器或附近文字顯示警告 (例如: "最多可輸入300字")，顏色變化以示提醒。

### 5.3. 儲存故事

*   **觸發**: 點擊「儲存」按鈕。
*   **載入指示**: 點擊儲存後，應立即顯示載入指示器 (Activity Indicator)，直到儲存流程完成 (成功或失敗)。
*   **確認提示**: 顯示警告對話框：「儲存後將覆蓋原照片檔案，是否繼續？」。
    *   按鈕: 「確認」、「取消」。
*   **儲存成功**: 顯示簡短的成功 Toast 訊息 (例如: "故事已儲存")，持續3秒後自動消失。輸入框內容應為最新儲存的內容。載入指示器消失。
*   **儲存失敗**: 顯示明確的錯誤 Toast 訊息 (例如: "儲存失敗，請檢查儲存權限")，持續3秒後自動消失。載入指示器消失。若錯誤需要使用者進一步操作 (例如，權限問題引導去設定)，則可考慮使用 Alert。

### 5.4. 讀取故事

*   當使用者選擇一張已有故事的照片時 (且格式支援)，故事內容應自動載入到文字輸入框中。
*   **讀取失敗**: 若讀取照片或故事失敗，顯示明確的錯誤 Toast 訊息 (例如: "照片讀取失敗")，持續3秒後自動消失。

### 5.5. 不支援格式處理

*   **時機**: 當使用者在相簿瀏覽頁選擇了目前不支援的照片格式時 (例如 HEIC)。
*   **互動**: 顯示 Toast 提示：「格式暫不支援」，持續3秒後自動消失。使用者操作流程返回相簿瀏覽頁，或該照片無法被選取。

## 6. 本地化 (Localization)

所有使用者可見的 UI 字串 (按鈕文字、提示訊息、Placeholder等) 都需要支援以下語系：

*   `zh-Hant` (繁體中文)
*   `en` (英文)

涉及的字串範例 (需整理至 `Localizable.strings`)：

*   "在這裡寫下照片的故事..."
*   "儲存"
*   "取消"
*   "確認"
*   "儲存後將覆蓋原照片檔案，是否繼續？"
*   "故事已儲存"
*   "儲存失敗，請檢查儲存權限"
*   "照片讀取失敗"
*   "格式暫不支援"
*   "最多可輸入300字"
*   "[目前字數]/300 字"
*   相簿權限相關提示文字。
*   錯誤處理相關提示文字 (權限/讀取/寫入/未知)。

---
文件結束 